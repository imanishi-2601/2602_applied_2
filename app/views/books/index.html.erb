<!-- エラーメッセージ -->
<% if @book.errors.any? %>
  <div class="alert alert-danger">
    <ul>
      <% @book.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
    </ul>
  </div>
<% end %>

<div class="user-show">
  <!-- 左：User info + New book -->
  <div class="user-left">


    <h1>User info</h1>

    <div class="avatar-box">
      <% if @user.profile_image.attached? %>
        <%= image_tag @user.profile_image, class: "avatar-image" %>
      <% else %>
        <%= image_tag "no_image.jpg", class: "avatar-image" %>
      <% end %>
    </div>

    <table>
      <tr>
        <th>name</th>
        <td><%= @user.name %></td>
      </tr>
      <tr>
        <th>introduction</th>
        <td><%= @user.introduction %></td>
      </tr>
    </table>

    <%= link_to edit_user_path(@user) do %>
      <i class="fa-solid fa-user-gear"></i>
    <% end %>

    <%= link_to edit_user_path(@user) do %>
      <i class="fa-solid fa-user-gear"></i>
    <% end %>

    <h1>New book</h1>


    <%= form_with model: @book, local: true do |f| %>
      <h3>Title</h3>
      <%= f.text_field :title %>

      <h3>Opinion</h3>
      <%= f.text_area :body %>

      <div class="form-actions">
        <%= f.submit "Create Book" %>
      </div>
    <% end %>
  </div>

  <!-- 右：Books一覧（Title / Opinion） -->
  <div class="user-right">
    <h1>Books</h1>

    <table class="users-table">
      <thead>
        <tr>
          <th class="book-image"></th>
          <th>Title</th>
          <th>Opinion</th>
        </tr>
      </thead>
      <tbody>
        <% @books.each do |book| %>
          <tr>
                <!-- Image -->
          </td>
            <td>
              <%= link_to user_path(book.user) do %>
                <% if book.user.profile_image.attached? %>
                  <%= image_tag book.user.profile_image, width: 60, height: 60 %>
                <% else %>
                  <%= image_tag "no_image.jpg", width: 60, height: 60 %>
                <% end %>
              <% end %>
            </td>

            <!-- Title（クリックで show） -->
            <td><%= link_to book.title, book_path(book) %></td>

            <!-- Opinion -->
            <td><%= book.body %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>